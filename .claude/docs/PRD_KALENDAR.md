# Kalendar 서비스 기획서 (PRD)

> **문서 버전**: v1.1
> **작성일**: 2025-12-20
> **기반 자료**: 사용자 제공 기획 텍스트 + API_REFERENCE.md

---

## 1. 프로젝트 개요

| 항목 | 내용 |
|------|------|
| **서비스명** | Kalendar (캘린더) |
| **서비스 목적** | K-POP 팬덤을 위한 일정 관리 및 팬 파티 매칭 플랫폼 |
| **타겟 사용자** | K-POP 아티스트 팬덤 |
| **핵심 가치** | 팔로잉 아티스트의 일정을 한눈에 확인하고, 같은 공연에 가는 팬들과 매칭 |

---

## 2. 사용자 유형 및 권한 매트릭스

### 2.1 사용자 유형

| 유형 | 설명 |
|------|------|
| **비회원 (게스트)** | 로그인 없이 서비스 이용 |
| **회원** | 일반 로그인 사용자 |
| **파티 리더 (방장)** | 파티 생성자, 관리 권한 보유 |

### 2.2 기능별 권한 매트릭스

| 기능 | 비회원 | 회원 | 비고 |
|------|:------:|:----:|------|
| 아티스트 선택 | ✅ | ✅ | 브라우저 저장 |
| 일정 캘린더 조회 | ✅ | ✅ | |
| 일정 상세 보기 | ✅ | ✅ | |
| 알림 설정 | ❌ | ✅ | 로그인 필요 안내 |
| 아티스트 관리 | ❌ | ✅ | 로그인 필요 안내 |
| 예매하기 | ❌ | ✅ | 로그인 필요 안내 |
| 팬 파티 매칭 | ❌ | ✅ | 로그인 필요 안내 |
| 마이페이지 | ❌ | ✅ | |
| 채팅 | ❌ | ✅ | |

---

## 3. 핵심 기능 명세

### 3.1 온보딩 (최초 접속)

**플로우:**
1. 최초 접속 시 **선호 아티스트 선택 화면** 표시
2. 선택 내용은 **브라우저(localStorage)에 저장**
3. 이후 재접속 시 바로 캘린더 화면으로 이동

**저장 데이터:**
- 선택한 아티스트 ID 목록
- 선택 완료 여부 플래그

---

### 3.2 아티스트 관리

**기능:**
- 아티스트 선택 시 해당 아티스트 일정만 **필터링** 표시
- 노출되는 아티스트는 **팔로잉한 아티스트**만

**[내 아티스트 관리] 버튼:**
- 클릭 시 → 아티스트 목록 페이지(`/artists`) 이동
- **비로그인 시** → 로그인 페이지로 리다이렉트

**아티스트 목록 페이지 기능:**
- 아티스트 검색/필터링
- 아티스트 팔로잉 **추가/삭제**
- 팔로잉 목록 조회

---

### 3.3 캘린더 및 일정 조회

**레이아웃 (데스크탑):**
```
┌─────────────────────────────────────────────────────┐
│                     Header                          │
├─────────────────────────────┬───────────────────────┤
│                             │                       │
│       캘린더 (70%)          │  다가오는 일정 (30%)   │
│                             │                       │
└─────────────────────────────┴───────────────────────┘
```

**기능:**
- 일정 선택 시 해당 날짜의 세부 일정 확인
- 다가오는 일정 사이드바에서 빠른 접근

---

### 3.4 일정 상세 페이지

**레이아웃:**
```
┌─────────────────────────────┬───────────────────────┐
│                             │                       │
│      공연 정보 (좌측)        │   공연 회차 (우측)     │
│                             │                       │
└─────────────────────────────┴───────────────────────┘
```

**카테고리별 버튼 표시 규칙:**

| 일정 카테고리 | 표시 버튼 | 동작 |
|--------------|----------|------|
| 콘서트 (`CONCERT`) | [예매하기] | 좌석 선택 → 결제 |
| 팬미팅 (`FAN_MEETING`) | [예매하기] | 좌석 선택 → 결제 |
| 방송, 팬사인회 등 | [신청하기] | 외부 링크로 이동 |
| 생일 (`BIRTHDAY`), 기념일 | [알림] | 알림 설정만 가능 |

**비로그인 시:**
- [예매하기], [신청하기], [알림] 버튼 클릭 → 로그인 페이지 이동

**추가 기능:**
- [파티 찾기] 버튼 → 팬 파티 매칭 페이지 이동 (로그인 필요)

---

### 3.5 예매 시스템

#### 3.5.1 좌석 선택

**UI 방식:** 팝업 모달

**플로우:**
1. 좌석 배치도에서 **구역 선택**
2. 구역별 좌석 선택 화면으로 이동
3. 특정 좌석 선택 시 **[좌석 선택 완료]** 버튼 활성화

**데이터:**
- 좌석 형태/배치 데이터는 **백엔드에서 전달**
- 1차: 예제 데이터로 공연장 지정하여 전달
- 2차: 내부 데이터 정해서 전달

#### 3.5.2 결제

**배송 방법:**
| 옵션 | 설명 |
|------|------|
| 배송 | 배송지 정보 입력 필요 |
| 현장수령 | 공연장에서 수령 |
| 온라인 티켓 | *추후 구현 예정* |

**결제수단:** (택 1)
- 토스페이
- 카카오페이
- 네이버페이

**결제 완료 후:**
1. 예매 완료 페이지 표시
2. [예매내역확인] 버튼 → 마이페이지 - 예매내역 페이지 이동

---

### 3.6 팬 파티 매칭

#### 3.6.1 파티 유형

| 타입 | Enum 값 | 설명 |
|------|---------|------|
| 출발팟 | `LEAVE` | 공연장으로 함께 이동 |
| 복귀팟 | `ARRIVE` | 공연 후 함께 복귀 |
| 동행파티 | - | *2차 개발 예정* |

#### 3.6.2 파티 목록 페이지

**기능:**
- 파티 목록 조회 및 필터링
- **파티 카드에 모든 정보 표시** (파티명, 출발/도착지, 이동수단, 인원, 선호조건, 출발시간)
- **[참여하기] 버튼** → 파티 카드에서 바로 신청 (별도 상세 페이지 없음)
- [+] 버튼 → 새 팬 파티 만들기 페이지 이동
- 로그인 필요

**필터 옵션:**
| 필터 | 옵션 |
|------|------|
| 이벤트 (스케줄) | 드롭다운으로 공연/일정 선택 |
| 파티 유형 | 전체 / 출발팟 / 복귀팟 |
| 이동 수단 | 택시 / 카풀 / 지하철 / 버스 / 도보 |

#### 3.6.3 파티 생성

**입력 항목:**
- 파티 이름
- 이동 수단 (`TAXI`, `CARPOOL`, `SUBWAY`, `BUS`, `WALK`)
- 출발/도착 장소
- 모집 인원
- **선호하는 성별** (`MALE`, `FEMALE`, `ANY`)
- **선호하는 나이대** (`TEEN`, `TWENTY`, `THIRTY`, `FORTY`, `FIFTY_PLUS`, `NONE`)

**완료 후:**
- [파티 만들기] 또는 [취소] → 팬 파티 매칭 목록으로 이동

#### 3.6.4 파티 신청

**신청 플로우:**
1. 파티 목록에서 [참여하기] 버튼 클릭
2. 팝업: "나의 개인 정보를 담은 신청 알림을 보냅니다."
3. 확인 → 방장에게 알림 전송

**방장 알림 내용:**
- 신청자 닉네임
- 신청자 나이
- 신청자 성별

**신청자 알림:**
- 방장 수락 시 → 승인 알림 수신

#### 3.6.5 역할별 권한

| 권한/기능 | 방장 (Leader) | 참가자 (Member) |
|----------|:-------------:|:---------------:|
| 파티 나가기 | ❌ | ✅ |
| 다른 참가자 강퇴 | ✅ | ❌ |
| 신청자 관리 (수락/거절) | ✅ | ❌ |
| 채팅방 이동 | ✅ | ✅ |

**강퇴 방법:**
- 상대방 프로필 이미지 클릭 → 강퇴 버튼 포함 메뉴 표시
- 햄버거바 → 참가자 목록 → 프로필 클릭 → 강퇴

#### 3.6.6 내 파티 관리 (필터 방식)

**표시 방식:**
- 내가 속한 **모든 파티**를 한 번에 표시 (생성 + 신청)
- **[방장👑] 뱃지** → 내가 만든 파티 표시

**상태 필터:**
| 필터 | 설명 |
|------|------|
| 전체 | 모든 파티 |
| 승인 대기중 | 신청 후 방장 승인 대기 |
| 참여중 | 승인 완료, 현재 활동 중 (채팅방 이동 가능) |
| 종료됨 | 완료/취소된 파티 |

**방장 전용 기능:**
- [신청자 관리] 버튼 → 신청자 목록에서 수락/거절

---

### 3.7 채팅 시스템

**접근:**
- [채팅방] 버튼 → 참여 중인 채팅방 목록
- 마이페이지, 최상단 바에서 어디서든 접근 가능

**규칙:**
- **종료된 채팅은 목록에 표시되지 않음**
- 방장: 강퇴 가능 (프로필 클릭 메뉴)
- 참가자: 나가기 가능

**참가자 목록:**
- 햄버거바 버튼 → 참가자 목록 확인

---

### 3.8 알림 시스템

**알림 발송 시간:** 00:00 (자정)

**적용 범위:** 모든 일정에 알림 설정 가능

**알림 유형:**
| 알림 종류 | 트리거 |
|----------|--------|
| 일정 리마인드 | 설정된 일정 당일 00시 |
| 파티 신청 알림 | 신청자가 파티 신청 시 (방장에게) |
| 파티 승인 알림 | 방장이 수락 시 (신청자에게) |
| 강퇴 알림 | 채팅방에서 강퇴 시 |
| 채팅 종료 알림 | 채팅방 종료 시 |

---

### 3.9 마이페이지

**접근:** 로그인 시 최상단 바에서 어디서든 접근 가능

**주요 메뉴:**
- 프로필 정보
- 예매 내역
- 내 파티 (상태 필터로 조회)
- 알림 설정
- 설정

---

### 3.10 레벨/평가 시스템

#### 3.10.1 레벨 표시

**표시 위치:** 닉네임 옆에 인장 형태로 항상 표시
- 닉네임 확인 가능한 곳에서는 어디서든 레벨 확인 가능

#### 3.10.2 별점 평가 시점

| 상황 | 평가 대상 | UI |
|------|----------|-----|
| 채팅방에서 **강퇴당했을 때** | 해당 방의 다른 참여자들 | 알림 → [참여자 평가하기] 버튼 |
| 채팅방에서 **나갔을 때** | 해당 방의 다른 참여자들 | 팝업 → 평가 창 |
| 채팅방 **종료 시** (행사 종료) | 해당 방의 다른 참여자들 | 알림 → [참여자 평가하기] 버튼 |

---

## 4. 사용자 플로우

### 4.1 최초 접속 플로우

```
최초 접속 → 선호 아티스트 선택 → 브라우저 저장 → 캘린더 화면
                                           ↓
                               재접속 시 바로 캘린더
```

### 4.2 예매 플로우

```
일정 상세 → [예매하기] 클릭 → (로그인 확인)
                                    ↓ 비로그인
                              로그인 페이지
                                    ↓ 로그인됨
좌석 배치도 (팝업) → 구역 선택 → 좌석 선택 → [좌석 선택 완료]
                                                   ↓
배송 방법 선택 → 배송지 입력 (배송 시) → 결제수단 선택 → [결제하기]
                                                           ↓
                                               예매 완료 페이지
                                                   ↓
                                          [예매내역확인] → 마이페이지
```

### 4.3 파티 참여 플로우

```
[파티 찾기] → 파티 목록 → [참여하기] 버튼 클릭
                                    ↓
                           개인정보 전송 동의 팝업
                                    ↓ 확인
                           방장에게 신청 알림 전송
                                          ↓
                                   방장 수락/거절
                                          ↓ 수락
                                   신청자에게 승인 알림
                                          ↓
                                   채팅방 참여 가능
```

---

## 5. 화면별 상세 명세

| 화면 | 경로 | 주요 기능 |
|------|------|----------|
| 온보딩 | `/onboarding` | 선호 아티스트 선택 |
| 캘린더 | `/kalendar` | 일정 캘린더 + 다가오는 일정 |
| 아티스트 목록 | `/artists` | 아티스트 검색/필터링/팔로잉 관리 |
| 일정 상세 | `/event/[eventId]` | 공연 정보 + 회차 선택 (캘린더에서 콘서트 스케줄 → 예매하기로 진입) |
| 좌석 선택 | `/event/[eventId]/seat-detail` | 좌석 배치도/선택 (팝업) |
| 결제 | `/payment` | 배송/결제 정보 입력 |
| 결제 완료 | `/payment/complete` | 예매 완료 확인 |
| 파티 목록 | `/party` | 파티 검색/필터링/참여하기 |
| 파티 생성 | `/party/create` | 새 파티 만들기 |
| 내 파티 | `/party/my-parties` | 내가 속한 파티 관리 (필터 방식) |
| 채팅 목록 | `/chats` | 참여 중인 채팅방 |
| 채팅방 | `/chats/[chatId]` | 실시간 채팅 |
| 마이페이지 | `/mypage` | 사용자 정보/설정 |
| 예매 내역 | `/mypage/bookings` | 예매 목록 |
| 로그인 | `/login` | 로그인 |
| 회원가입 | `/signup` | 회원가입 |

---

## 6. 데이터 구조 (Backend Enum 참조)

### Party 관련

| Enum | 값 | 설명 |
|------|-----|------|
| **PartyType** | `LEAVE`, `ARRIVE` | 출발팟, 복귀팟 |
| **PartyStatus** | `RECRUITING`, `CLOSED`, `COMPLETED`, `CANCELLED` | 모집중, 모집마감, 종료, 취소됨 |
| **TransportType** | `TAXI`, `CARPOOL`, `SUBWAY`, `BUS`, `WALK` | 이동수단 |
| **PreferredAge** | `TEEN`, `TWENTY`, `THIRTY`, `FORTY`, `FIFTY_PLUS`, `NONE` | 선호 연령대 |
| **Gender** | `MALE`, `FEMALE`, `ANY` | 선호 성별 |
| **MemberRole** | `LEADER`, `MEMBER` | 파티장, 멤버 |
| **ApplicationStatus** | `PENDING`, `APPROVED`, `REJECTED` | 신청 상태 |

### Schedule 관련

| Enum | 값 |
|------|-----|
| **ScheduleCategory** | `CONCERT`, `FAN_MEETING`, `BROADCAST`, `ONLINE_RELEASE`, `BIRTHDAY`, `FESTIVAL`, `AWARD_SHOW`, `ANNIVERSARY`, `FAN_SIGN`, `LIVE_STREAM`, `ETC` |
| **ScheduleStatus** | `READY`, `AVAILABLE`, `SOLD_OUT`, `CLOSED`, `CANCELLED` |

---

## 7. 2차 개발 예정 기능

| 기능 | 설명 | 우선순위 |
|------|------|----------|
| 매크로 방지 | 예매 시 봇 차단 | 높음 |
| 온라인/모바일 티켓팅 | 디지털 티켓 발급 | 중간 |
| 아티스트별 팔로우 숫자 | 인기도 표시 | 낮음 |
| 동행파티 | 이동 외 성격의 파티 | 중간 |
| 소셜 로그인 | 카카오, 구글 등 | 높음 |

---

## 8. 화면별 와이어프레임 (텍스트 기반)

### 8.1 온보딩 페이지 (`/onboarding`)

```
┌──────────────────────────────────────────────────────────────┐
│                        Header (로고)                          │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│              "좋아하는 아티스트를 선택하세요"                    │
│                                                              │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │
│   │  [IMG]  │  │  [IMG]  │  │  [IMG]  │  │  [IMG]  │        │
│   │  BTS    │  │BLACKPINK│  │  NCT    │  │ SEVENTEEN│       │
│   │   ✓     │  │         │  │   ✓     │  │         │        │
│   └─────────┘  └─────────┘  └─────────┘  └─────────┘        │
│                                                              │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │
│   │  [IMG]  │  │  [IMG]  │  │  [IMG]  │  │  [IMG]  │        │
│   │ STRAY   │  │  AESPA  │  │  IVE    │  │ NewJeans │       │
│   │  KIDS   │  │         │  │         │  │         │        │
│   └─────────┘  └─────────┘  └─────────┘  └─────────┘        │
│                                                              │
│                    [ 선택 완료 (n개 선택됨) ]                   │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

### 8.2 캘린더 페이지 (`/kalendar`) - 데스크탑

```
┌─────────────────────────────────────────────────────────────────────────┐
│  [≡]  Kalendar                    [검색] [알림🔔] [채팅💬] [프로필👤]   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─ 아티스트 필터 ──────────────────────────────────────────────────┐  │
│  │ [BTS ✓] [NCT ✓] [전체]                    [내 아티스트 관리 →]   │  │
│  └───────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│  ┌─ 캘린더 (70%) ───────────────────────┬─ 다가오는 일정 (30%) ──┐    │
│  │                                       │                        │    │
│  │        ◀  2025년 1월  ▶              │  📅 1/25 (토)          │    │
│  │  일  월  화  수  목  금  토           │  BTS 월드투어 서울     │    │
│  │                  1   2   3   4        │  잠실종합운동장        │    │
│  │   5   6   7   8   9  10  11          │  19:00                 │    │
│  │  12  13  14  15  16  17  18          │  ─────────────────     │    │
│  │  19  20  21  22  23  24 [25]         │  📅 1/28 (화)          │    │
│  │  26  27  28  29  30  31              │  NCT 팬미팅            │    │
│  │                                       │  올림픽홀              │    │
│  │  ● BTS 콘서트 (1/25)                 │  18:00                 │    │
│  │  ● NCT 팬미팅 (1/28)                 │                        │    │
│  │                                       │                        │    │
│  └───────────────────────────────────────┴────────────────────────┘    │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│  [🏠홈] [📅캘린더] [🎉파티] [👤마이]                                     │
└─────────────────────────────────────────────────────────────────────────┘
```

### 8.3 일정 상세 페이지 (`/event/[eventId]`)

```
┌──────────────────────────────────────────────────────────────┐
│  ← 뒤로                                               [공유]  │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─ 공연 정보 (좌측 50%) ───┬─ 회차 선택 (우측 50%) ────┐   │
│  │                          │                            │   │
│  │  ┌────────────────┐     │   선택된 날짜: 1/25 (토)   │   │
│  │  │                │     │                            │   │
│  │  │   포스터 이미지  │     │   ○ 1회차 15:00           │   │
│  │  │                │     │      잔여: 120석           │   │
│  │  │                │     │                            │   │
│  │  └────────────────┘     │   ● 2회차 19:00 (선택됨)   │   │
│  │                          │      잔여: 45석            │   │
│  │  BTS 월드투어 서울       │                            │   │
│  │  ─────────────────       │   ○ 3회차 21:00           │   │
│  │  📍 잠실종합운동장       │      매진                  │   │
│  │  📅 2025.01.25 ~ 01.27  │                            │   │
│  │  💰 VIP 180,000원       │                            │   │
│  │     R석 150,000원       │                            │   │
│  │     S석 110,000원       │                            │   │
│  │                          │                            │   │
│  └──────────────────────────┴────────────────────────────┘   │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  [ 알림 설정 🔔 ]    [ 파티 찾기 🎉 ]    [ 예매하기 → ] │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

### 8.4 좌석 선택 (팝업 모달)

```
┌──────────────────────────────────────────────────────────────┐
│  좌석 선택                                              [X]   │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│                    ┌─────────────────┐                       │
│                    │      STAGE      │                       │
│                    └─────────────────┘                       │
│                                                              │
│        ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐             │
│        │  VIP  │ │  VIP  │ │  VIP  │ │  VIP  │             │
│        │   A   │ │   B   │ │   C   │ │   D   │             │
│        └───────┘ └───────┘ └───────┘ └───────┘             │
│                                                              │
│     ┌─────────┐ ┌─────────────────────┐ ┌─────────┐        │
│     │   R석   │ │                     │ │   R석   │        │
│     │   좌측  │ │       R석 중앙       │ │   우측  │        │
│     └─────────┘ └─────────────────────┘ └─────────┘        │
│                                                              │
│     ┌───────────────────────────────────────────────┐       │
│     │                    S석                         │       │
│     └───────────────────────────────────────────────┘       │
│                                                              │
│  ● 선택가능  ○ 매진  ◐ 일부잔여                              │
│                                                              │
│  선택 구역: VIP A구역                                        │
│                                                              │
│            [ 좌석 선택 완료 ] (비활성 → 선택 시 활성화)       │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

### 8.5 파티 목록 페이지 (`/party`)

```
┌──────────────────────────────────────────────────────────────┐
│  ← 뒤로            팬 파티 매칭                         [+]   │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─ 이벤트 선택 ───────────────────────────────────────────┐ │
│  │ [ 전체 이벤트 ▼ ]                                       │ │
│  └───────────────────────────────────────────────────────┘   │
│                                                              │
│  ┌─ 필터 ───────────────────────────────────────────────┐   │
│  │ [전체] [출발팟] [복귀팟]  |  🚕택시 🚗카풀 🚇지하철    │   │
│  └───────────────────────────────────────────────────────┘   │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  🎵 BTS 콘서트 같이 가요!                   모집중 🟢   │ │
│  │  ───────────────────────────────────────────────────── │ │
│  │  📍 강남역 → 잠실종합운동장                             │ │
│  │  🚕 택시  |  👥 2/4명  |  👤 20대 여성 선호            │ │
│  │  📅 1/25 (토) 17:00 출발                               │ │
│  │  ─────────────────────────────────────────────────────  │ │
│  │                                      [ 참여하기 → ]    │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  🎵 NCT 팬미팅 복귀팟                       모집중 🟢   │ │
│  │  ───────────────────────────────────────────────────── │ │
│  │  📍 올림픽홀 → 강남역                                  │ │
│  │  🚇 지하철  |  👥 3/5명  |  👤 무관                    │ │
│  │  📅 1/28 (화) 21:00 출발                               │ │
│  │  ─────────────────────────────────────────────────────  │ │
│  │                                      [ 참여하기 → ]    │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  🎵 콘서트 끝나고 택시 동행                 마감 🔴     │ │
│  │  📍 잠실 → 홍대입구  |  🚕 택시  |  👥 4/4명           │ │
│  │  📅 1/25 (토) 22:00 출발                               │ │
│  │  ─────────────────────────────────────────────────────  │ │
│  │                                      [ 마감됨 ]        │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

### 8.6 채팅방 (`/chats/[chatId]`)

```
┌──────────────────────────────────────────────────────────────┐
│  ← 뒤로         BTS 콘서트 같이 가요 (4명)            [≡]    │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                    2025.01.24                          │  │
│  └───────────────────────────────────────────────────────┘  │
│                                                              │
│     [👤] 파티장님 (Lv.3 🏅)                                  │
│          안녕하세요! 내일 만나요~                            │
│                                            14:30            │
│                                                              │
│                                    [👤] 나                   │
│                             네! 강남역 몇 번 출구에서         │
│                                       만날까요?             │
│                                            14:32            │
│                                                              │
│     [👤] 멤버1 (Lv.2 ⭐)                                     │
│          저는 3번 출구가 편해요!                             │
│                                            14:35            │
│                                                              │
│     [👤] 파티장님 (Lv.3 🏅)                                  │
│          그럼 3번 출구에서 5시에 봬요~                       │
│                                            14:36            │
│                                                              │
├──────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────┐  ┌──────┐          │
│  │ 메시지 입력...                       │  │ 전송 │          │
│  └─────────────────────────────────────┘  └──────┘          │
└──────────────────────────────────────────────────────────────┘

* [≡] 햄버거 메뉴 클릭 시:
  ┌────────────────────┐
  │  참가자 목록        │
  │  ─────────────────  │
  │  👤 파티장 (방장)   │
  │  👤 멤버1          │
  │  👤 멤버2          │
  │  👤 나             │
  │  ─────────────────  │
  │  [ 나가기 ]        │  ← 참가자만 표시
  └────────────────────┘
```

### 8.7 내 파티 관리 (`/party/my-parties`)

```
┌──────────────────────────────────────────────────────────────┐
│  ← 뒤로                    내 파티                           │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌─ 상태 필터 ─────────────────────────────────────────────┐ │
│  │ [전체] [승인 대기중] [참여중] [종료됨]                    │ │
│  └───────────────────────────────────────────────────────┘   │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  🎵 BTS 콘서트 같이 가요!        [방장👑]   참여중 🟢   │ │
│  │  📍 강남역 → 잠실  |  👥 3/4명  |  📅 1/25 (토)        │ │
│  │  ───────────────────────────────────────────────────── │ │
│  │  [ 신청자 관리 (2) ]                    [ 채팅방 → ]    │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  🎵 NCT 팬미팅 복귀팟                     승인 대기중 🟡 │ │
│  │  📍 올림픽홀 → 강남  |  👥 2/5명  |  📅 1/28 (화)      │ │
│  │  ───────────────────────────────────────────────────── │ │
│  │                                       [ 신청 취소 ]    │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  🎵 세븐틴 콘서트 택시팟          [방장👑]   종료됨 ⚫   │ │
│  │  📍 잠실 → 홍대  |  👥 4/4명  |  📅 1/10 (금)          │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│  ── 신청자 관리 클릭 시 (방장 전용 팝업) ──                  │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  신청자 목록                                      [X]   │ │
│  │  ───────────────────────────────────────────────────── │ │
│  │  👤 닉네임1  |  25세  |  여성         [수락] [거절]     │ │
│  │  👤 닉네임2  |  28세  |  남성         [수락] [거절]     │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

### 8.8 평가 팝업 (나가기/강퇴/종료 시)

```
┌──────────────────────────────────────────────────────────────┐
│                     참여자 평가하기                           │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  함께한 멤버들을 평가해주세요!                                │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  👤 파티장님 (Lv.3 🏅)                                   │ │
│  │      ☆ ☆ ☆ ☆ ☆  →  ★ ★ ★ ★ ☆                       │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  👤 멤버1 (Lv.2 ⭐)                                      │ │
│  │      ☆ ☆ ☆ ☆ ☆  →  ★ ★ ★ ★ ★                       │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  👤 멤버2 (Lv.1)                                         │ │
│  │      ☆ ☆ ☆ ☆ ☆  →  ★ ★ ★ ☆ ☆                       │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                              │
│              [ 평가 완료 ]      [ 건너뛰기 ]                  │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

---

## 9. 기능별 API 엔드포인트 매핑

### 9.1 인증/사용자

| 기능 | Method | Endpoint | 비고 |
|------|--------|----------|------|
| 로그인 | POST | `/auth/login` | JWT 발급 |
| 로그아웃 | POST | `/auth/logout` | 토큰 무효화 |
| 토큰 갱신 | POST | `/auth/refresh` | refreshToken 사용 |
| 회원가입 | POST | `/user/` | 201 Created |
| 내 정보 조회 | GET | `/user/me` | 인증 필요 |
| 프로필 수정 | PATCH | `/user/me` | partial update |
| 프로필 이미지 | POST | `/user/me/profile-image` | multipart/form-data |
| 이메일 인증 발송 | POST | `/auth/email/send` | |
| 이메일 인증 확인 | POST | `/auth/email/verify` | code 필요 |
| 비밀번호 재설정 | POST | `/auth/password/reset` | token 필요 |

### 9.2 아티스트

| 기능 | Method | Endpoint | 비고 |
|------|--------|----------|------|
| 전체 아티스트 | GET | `/artist/` | Public |
| 팔로잉 목록 | GET | `/artist/following` | 인증 필요 |
| 팔로우 | POST | `/artist/{artistId}/follow` | 인증 필요 |
| 언팔로우 | DELETE | `/artist/{artistId}/unfollow` | 인증 필요 |

### 9.3 스케줄/일정

| 기능 | Method | Endpoint | 비고 |
|------|--------|----------|------|
| 팔로잉 아티스트 스케줄 | GET | `/schedule/following` | year, month 필수 |
| 파티 생성용 스케줄 | GET | `/schedule/partyList` | 인증 필요 |
| 공연 상세 | GET | `/performance/{id}` | 회차, 좌석 등급 포함 |

### 9.4 파티

| 기능 | Method | Endpoint | 비고 |
|------|--------|----------|------|
| 파티 목록 | GET | `/party/` | 페이징 |
| 스케줄별 파티 | GET | `/party/schedule/{scheduleId}` | 필터 가능 |
| 파티 생성 | POST | `/party/` | 인증, 방장 됨 |
| 파티 수정 | PUT | `/party/{partyId}` | 방장만 |
| 파티 삭제 | DELETE | `/party/{partyId}` | 방장만 |
| 파티 신청 | POST | `/party/{partyId}/application/apply` | 인증 필요 |
| 신청 취소 | DELETE | `/party/{partyId}/application/{id}/cancel` | |
| 신청 수락 | PATCH | `/party/{partyId}/application/{id}/accept` | 방장만 |
| 신청 거절 | PATCH | `/party/{partyId}/application/{id}/reject` | 방장만 |
| 신청자 목록 | GET | `/party/{partyId}/application/applicants` | 방장만 |
| 멤버 목록 | GET | `/party/{partyId}/members` | Public |
| 내가 만든 파티 | GET | `/party/user/me/party/created` | 인증 필요 |
| 내가 신청한 파티 | GET | `/party/user/me/party/application` | 인증 필요 |

---

## 10. 비즈니스 규칙 상세

### 10.1 파티 신청 규칙

```
신청 가능 조건:
├── 로그인 상태
├── 이미 해당 파티 멤버가 아님
├── 이미 신청 중이 아님 (PENDING 상태)
└── 파티 정원이 차지 않음 (currentMembers < maxMembers)

신청 불가 시 응답:
├── 400: 이미 신청함 / 정원 초과
└── 409: 이미 멤버임
```

### 10.2 파티 상태 전이

```
RECRUITING (모집중)
    │
    ├── [수락으로 정원 도달] → CLOSED (모집마감)
    │
    ├── [방장 수동 마감] → CLOSED (모집마감)
    │
    ├── [공연 종료] → COMPLETED (종료)
    │
    └── [방장 삭제] → CANCELLED (취소됨)

CLOSED (모집마감)
    │
    ├── [공연 종료] → COMPLETED (종료)
    │
    └── [멤버 탈퇴로 정원 미달] → RECRUITING (모집중)
```

### 10.3 알림 발송 규칙

| 이벤트 | 수신자 | 발송 시점 |
|--------|--------|----------|
| 일정 리마인드 | 알림 설정한 사용자 | 당일 00:00 |
| 파티 신청 | 방장 | 즉시 |
| 신청 수락 | 신청자 | 즉시 |
| 신청 거절 | 신청자 | 즉시 |
| 강퇴 | 강퇴된 사용자 | 즉시 |
| 채팅방 종료 | 모든 멤버 | 공연 종료 시 |

### 10.4 레벨 시스템 (추정)

```
레벨 산정 기준 (추정):
├── 파티 참여 횟수
├── 받은 별점 평균
├── 강퇴 이력 (감점 요소)
└── 활동 기간

레벨 표시:
├── Lv.1: 기본
├── Lv.2: ⭐
├── Lv.3: 🏅
├── Lv.4: 🎖️
└── Lv.5: 👑
```

---

## 11. 에러 처리 시나리오

### 11.1 인증 에러

| 상황 | 에러 코드 | 사용자 안내 |
|------|----------|------------|
| 비밀번호 불일치 | 401 | "비밀번호가 일치하지 않습니다" |
| 이메일 없음 | 404 | "존재하지 않는 이메일입니다" |
| 이메일 중복 | 409 | "이미 사용 중인 이메일입니다" |
| 토큰 만료 | 401 | 자동 갱신 시도 → 실패 시 로그인 페이지 |

### 11.2 파티 에러

| 상황 | 에러 코드 | 사용자 안내 |
|------|----------|------------|
| 정원 초과 | 400 | "모집 인원이 마감되었습니다" |
| 이미 멤버 | 409 | "이미 참여 중인 파티입니다" |
| 권한 없음 | 403 | "파티장만 가능한 기능입니다" |
| 파티 없음 | 404 | "존재하지 않는 파티입니다" |

---

## 12. 관련 문서

| 문서 | 위치 | 설명 |
|------|------|------|
| API Reference | `.claude/testing/API_REFERENCE.md` | 백엔드 API 상세 스펙 |
| E2E Test Scenarios | `.claude/testing/E2E_TEST_SCENARIOS.md` | 52개 테스트 시나리오 |
| Test Data | `.claude/testing/TEST_DATA.md` | 테스트 데이터 정의 |
| Auth Credentials | `.claude/testing/AUTH_CREDENTIALS.md` | 테스트 계정 정보 |
| Project Guide | `.claude/CLAUDE.md` | 개발 규칙 및 가이드 |
